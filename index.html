<!-- Professional Payment Entry UI with Full Google Sheets Sync -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Payment Entry Dashboard</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f4f6f9;
      color: #333;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background: white;
      padding: 30px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      border-radius: 8px;
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
    }
    form label {
      display: block;
      margin-top: 10px;
      font-weight: 500;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button {
      padding: 10px 20px;
      margin: 10px 5px 0 0;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 600;
    }
    .btn-primary { background: #007BFF; color: white; }
    .btn-warning { background: #FFC107; color: white; }
    .btn-danger { background: #DC3545; color: white; }
    .btn-secondary { background: #6C757D; color: white; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background: #f1f1f1;
    }
    .actions button {
      margin-right: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Payment Entry</h2>
    <form id="entryForm">
      <input type="hidden" id="entryId">
      <label>Date: <input type="date" id="date" required></label>
      <label>Ins#: <input type="text" id="ins"></label>
      <label>Identifier: <input type="text" id="identifier"></label>
      <label>Transaction: <input type="text" id="transaction"></label>
      <label>Currency:
        <select id="currency" required>
          <option value="PKR">PKR</option>
          <option value="AED">AED</option>
        </select>
      </label>
      <label>Amount: <input type="number" id="amount" required></label>
      <label>Bank:
        <select id="bank" required>
          <option value="PAK - Mate Enterprise : Bank Alfalah - 6035">PAK - Mate Enterprise : Bank Alfalah - 6035</option>
          <option value="DXB - AAA FD : ENBD">DXB - AAA FD : ENBD</option>
          <option value="PAK - AAA Reels : Bank Alfalah - 0862">PAK - AAA Reels : Bank Alfalah - 0862</option>
          <option value="Fair Deal Marketing - 0001 bank islam">Fair Deal Marketing - 0001 bank islam</option>
          <option value="PAK - Saqib Anjum :">PAK - Saqib Anjum :</option>
          <option value="DXB - Mate Enterprise : UBL - 6743">DXB - Mate Enterprise : UBL - 6743</option>
          <option value="DXB - Pind Café : RAK">DXB - Pind Café : RAK</option>
          <option value="PAK - Cash Received">PAK - Cash Received</option>
          <option value="DXB - CEO : EIB">DXB - CEO : EIB</option>
          <option value="DXB - Mate Enterprise : EIB - 8901">DXB - Mate Enterprise : EIB - 8901</option>
          <option value="DXB - Cash Received">DXB - Cash Received</option>
          <option value="PAK - Mate Enterprise : Bank Alfalah - 9289">PAK - Mate Enterprise : Bank Alfalah - 9289</option>
        </select>
      </label>
      <label>From: <input type="text" id="from"></label>
      <label>Remarks: <input type="text" id="remarks"></label>
      <div>
        <button type="button" class="btn-primary" onclick="submitEntry()">Save</button>
        <button type="button" class="btn-warning" onclick="updateEntry()" style="display:none">Update</button>
        <button type="button" class="btn-secondary" onclick="resetForm()">Cancel</button>
        <button type="button" class="btn-primary" onclick="exportToExcel()">Export to Excel</button>
      </div>
    </form>

    <table id="dataTable">
      <thead>
        <tr>
          <th>Date</th><th>Ins#</th><th>Identifier</th><th>Transaction</th>
          <th>Currency</th><th>Amount</th><th>Bank</th><th>From</th><th>Remarks</th><th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

<script>
const scriptURL = 'https://script.google.com/macros/s/AKfycbyKNLt1D6LlGZ6N2JUBERCRkweX_he7LbSe5OB8nQro0GUg6tsVLfICtARj0MMAaKyUEQ/exec';

window.onload = () => {
  fetch(scriptURL)
    .then(res => res.json())
    .then(data => data.forEach(row => appendRow(row)))
    .catch(err => console.error(err));
};

function submitEntry() {
  const row = getFormData();
  row.id = Date.now().toString();
  fetch(scriptURL, {
    method: 'POST',
    body: JSON.stringify(row)
  }).then(res => res.text()).then(() => {
    appendRow(row);
    resetForm();
  });
}

function updateEntry() {
  const row = getFormData();
  fetch(scriptURL + '?id=' + row.id, {
    method: 'PUT',
    body: JSON.stringify(row)
  }).then(res => res.text()).then(() => {
    location.reload();
  });
}

function deleteEntry(id) {
  if (!confirm("Delete this entry?")) return;
  fetch(scriptURL + '?id=' + id, { method: 'DELETE' })
    .then(res => res.text())
    .then(() => location.reload());
}

function appendRow(row) {
  const table = document.querySelector("#dataTable tbody");
  const newRow = table.insertRow();
  newRow.innerHTML = `
    <td>${row.date}</td>
    <td>${row.ins}</td>
    <td>${row.identifier}</td>
    <td>${row.transaction}</td>
    <td>${row.currency}</td>
    <td>${row.amount}</td>
    <td>${row.bank}</td>
    <td>${row.from}</td>
    <td>${row.remarks}</td>
    <td class="actions">
      <button class="btn-warning" onclick='loadEntry(${JSON.stringify(row)})'>Edit</button>
      <button class="btn-danger" onclick='deleteEntry("${row.id}")'>Delete</button>
    </td>`;
}

function loadEntry(row) {
  document.getElementById('entryId').value = row.id;
  document.getElementById('date').value = row.date;
  document.getElementById('ins').value = row.ins;
  document.getElementById('identifier').value = row.identifier;
  document.getElementById('transaction').value = row.transaction;
  document.getElementById('currency').value = row.currency;
  document.getElementById('amount').value = row.amount;
  document.getElementById('bank').value = row.bank;
  document.getElementById('from').value = row.from;
  document.getElementById('remarks').value = row.remarks;
  document.querySelector(".btn-primary").style.display = "none";
  document.querySelector(".btn-warning").style.display = "inline-block";
}

function resetForm() {
  document.getElementById("entryForm").reset();
  document.getElementById("entryId").value = "";
  document.querySelector(".btn-primary").style.display = "inline-block";
  document.querySelector(".btn-warning").style.display = "none";
}

function getFormData() {
  return {
    id: document.getElementById('entryId').value,
    date: document.getElementById('date').value,
    ins: document.getElementById('ins').value,
    identifier: document.getElementById('identifier').value,
    transaction: document.getElementById('transaction').value,
    currency: document.getElementById('currency').value,
    amount: document.getElementById('amount').value,
    bank: document.getElementById('bank').value,
    from: document.getElementById('from').value,
    remarks: document.getElementById('remarks').value
  };
}

function exportToExcel() {
  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.table_to_sheet(document.getElementById("dataTable"));
  XLSX.utils.book_append_sheet(wb, ws, "Payments");
  XLSX.writeFile(wb, "payment_entries.xlsx");
}
</script>
</body>
</html>
