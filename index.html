<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Payment Entry</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial; padding: 20px; background: #f9f9f9; }
    input, select, button { margin: 6px 0; padding: 10px; width: 100%; max-width: 400px; display: block; }
    table, th, td { border: 1px solid black; border-collapse: collapse; padding: 6px; }
    table { margin-top: 20px; width: 100%; max-width: 100%; overflow-x: auto; }
    th { background: #eaeaea; }
    h2, h3 { color: #333; }
  </style>
</head>
<body>

  <h2>Payment Entry</h2>

  <form id="entryForm">
    <label>Date: <input type="date" id="date" required></label>
    <label>Ins#: <input type="text" id="ins"></label>
    <label>Identifier: <input type="text" id="identifier"></label>
    <label>Transaction: <input type="text" id="transaction"></label>

    <label>Currency:
      <select id="currency" required>
        <option value="PKR">PKR</option>
        <option value="AED">AED</option>
      </select>
    </label>

    <label>Amount: <input type="number" id="amount" required></label>

    <label>Bank:
      <select id="bank" required>
        <option value="PAK - Mate Enterprise : Bank Alfalah - 6035">PAK - Mate Enterprise : Bank Alfalah - 6035</option>
        <option value="DXB - AAA FD : ENBD">DXB - AAA FD : ENBD</option>
        <option value="PAK - AAA Reels : Bank Alfalah - 0862">PAK - AAA Reels : Bank Alfalah - 0862</option>
        <option value="Fair Deal Marketing - 0001 bank islam">Fair Deal Marketing - 0001 bank islam</option>
        <option value="PAK - Saqib Anjum :">PAK - Saqib Anjum :</option>
        <option value="DXB - Mate Enterprise : UBL - 6743">DXB - Mate Enterprise : UBL - 6743</option>
        <option value="DXB - Pind Café : RAK">DXB - Pind Café : RAK</option>
        <option value="PAK - Cash Received">PAK - Cash Received</option>
        <option value="DXB - CEO : EIB">DXB - CEO : EIB</option>
        <option value="DXB - Mate Enterprise : EIB - 8901">DXB - Mate Enterprise : EIB - 8901</option>
        <option value="DXB - Cash Received">DXB - Cash Received</option>
        <option value="PAK - Mate Enterprise : Bank Alfalah - 9289">PAK - Mate Enterprise : Bank Alfalah - 9289</option>
      </select>
    </label>

    <label>From: <input type="text" id="from"></label>
    <label>Remarks: <input type="text" id="remarks"></label>

    <button type="button" onclick="addEntry()">Save Entry</button>
  </form>

  <h3>Session Preview</h3>
  <table id="previewTable">
    <thead>
      <tr>
        <th>Date</th>
        <th>Ins#</th>
        <th>Identifier</th>
        <th>Transaction</th>
        <th>Currency</th>
        <th>Amount</th>
        <th>Bank</th>
        <th>From</th>
        <th>Remarks</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzRbyCCUUJYZBhbBcUTvy6tBM-oWwmoGS46eCrQ8YVxb1PH_4AK8XU7d5EB-rwnCoCl1Q/exec';
    let sessionEntries = [];

    function addEntry() {
      const row = {
        date: document.getElementById('date').value,
        ins: document.getElementById('ins').value,
        identifier: document.getElementById('identifier').value,
        transaction: document.getElementById('transaction').value,
        currency: document.getElementById('currency').value,
        amount: parseFloat(document.getElementById('amount').value),
        bank: document.getElementById('bank').value,
        from: document.getElementById('from').value,
        remarks: document.getElementById('remarks').value
      };

      fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify(row),
        headers: {
          'Content-Type': 'application/json'
        }
      })
      .then(() => {
        alert("✅ Entry saved");
        sessionEntries.push(row);
        updatePreviewTable();
        document.getElementById("entryForm").reset();
      })
      .catch(err => {
        alert("❌ Error saving entry: " + err);
      });
    }

    function updatePreviewTable() {
      const tableBody = document.querySelector("#previewTable tbody");
      tableBody.innerHTML = "";
      sessionEntries.forEach(entry => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${entry.date}</td>
          <td>${entry.ins}</td>
          <td>${entry.identifier}</td>
          <td>${entry.transaction}</td>
          <td>${entry.currency}</td>
          <td>${entry.amount}</td>
          <td>${entry.bank}</td>
          <td>${entry.from}</td>
          <td>${entry.remarks}</td>
        `;
        tableBody.appendChild(tr);
      });
    }
  </script>

</body>
</html>
